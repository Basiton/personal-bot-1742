#!/usr/bin/env python3
"""
–¢–µ—Å—Ç–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ—Ñ–∏–ª—è–º–∏.
–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑ –∑–∞–ø—É—Å–∫–∞ –ø–æ–ª–Ω–æ–≥–æ –±–æ—Ç–∞.
"""

import os
import asyncio
from pathlib import Path

# –ò–º–∏—Ç–∞—Ü–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Ç–µ—Å—Ç–∞
def setup_test_env():
    """–°–æ–∑–¥–∞—ë—Ç —Ç–µ—Å—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è"""
    test_accounts = {
        '1': {
            'phone': '+1234567890',
            'session': 'test_session_string_1',
            'proxy': 'socks5:proxy1.com:1080:user1:pass1'
        },
        '2': {
            'phone': '+0987654321',
            'session': 'test_session_string_2',
            'proxy': 'socks5:proxy2.com:1080:user2:pass2'
        },
        '3': {
            'phone': '+1112223333',
            'session': 'test_session_string_3',
            'proxy': ''
        },
        '4': {
            'phone': '+4445556666',
            'session': '',  # –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
            'proxy': ''
        },
        '5': {
            'phone': '+7778889999',
            'session': 'test_session_string_5',
            'proxy': 'socks5:proxy5.com:1080:user5:pass5'
        }
    }
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    for num, data in test_accounts.items():
        os.environ[f'ACCOUNT_{num}_PHONE'] = data['phone']
        os.environ[f'ACCOUNT_{num}_SESSION'] = data['session']
        if data['proxy']:
            os.environ[f'ACCOUNT_{num}_PROXY'] = data['proxy']
    
    print("‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω—ã")
    return test_accounts

def get_all_accounts_from_env():
    """
    –ò–º–∏—Ç–∞—Ü–∏—è —Ñ—É–Ω–∫—Ü–∏–∏ get_all_accounts_from_env –∏–∑ main.py
    """
    accounts = []
    n = 1
    while True:
        phone_key = f'ACCOUNT_{n}_PHONE'
        phone = os.getenv(phone_key)
        
        if not phone:
            break
        
        session = os.getenv(f'ACCOUNT_{n}_SESSION', '')
        proxy_str = os.getenv(f'ACCOUNT_{n}_PROXY', '')
        
        # Parse proxy if exists
        proxy = None
        if proxy_str:
            try:
                parts = proxy_str.split(':')
                if len(parts) >= 5:
                    proxy = (parts[0], parts[1], int(parts[2]), parts[3], parts[4])
            except:
                print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–∞—Ä—Å–∏—Ç—å –ø—Ä–æ–∫—Å–∏ –¥–ª—è ACCOUNT_{n}")
        
        accounts.append((n, phone, session, proxy))
        n += 1
    
    return accounts

def display_accounts_keyboard(accounts, page=0, per_page=5):
    """
    –ò–º–∏—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∏—è –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã —Å –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
    """
    total_accounts = len(accounts)
    total_pages = (total_accounts + per_page - 1) // per_page
    page = max(0, min(page, total_pages - 1))
    
    start_idx = page * per_page
    end_idx = min(start_idx + per_page, total_accounts)
    
    print(f"\n{'='*60}")
    print(f"üîê –£–ü–†–ê–í–õ–ï–ù–ò–ï –ü–†–û–§–ò–õ–Ø–ú–ò –ê–ö–ö–ê–£–ù–¢–û–í")
    print(f"{'='*60}")
    print(f"–ù–∞–π–¥–µ–Ω–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: {total_accounts}")
    print(f"–°—Ç—Ä–∞–Ω–∏—Ü–∞: {page+1}/{total_pages}")
    print(f"{'='*60}\n")
    
    for i in range(start_idx, end_idx):
        num, phone, session, proxy = accounts[i]
        status = "‚úÖ" if session else "‚ùå"
        proxy_status = "üåê" if proxy else ""
        print(f"  [{status}] –ê–∫–∫–∞—É–Ω—Ç {num} - {phone} {proxy_status}")
    
    print(f"\n{'='*60}")
    if page > 0:
        print("  [‚óÄÔ∏è –ù–∞–∑–∞–¥]", end="")
    if total_pages > 1:
        print(f"  [üìÑ {page+1}/{total_pages}]", end="")
    if page < total_pages - 1:
        print("  [–í–ø–µ—Ä—ë–¥ ‚ñ∂Ô∏è]", end="")
    print("\n  [üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é]")
    print(f"{'='*60}\n")

def display_account_menu(account_num, phone, session):
    """
    –ò–º–∏—Ç–∞—Ü–∏—è –º–µ–Ω—é –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
    """
    print(f"\n{'='*60}")
    print(f"üîê –ê–ö–ö–ê–£–ù–¢ #{account_num}")
    print(f"{'='*60}")
    print(f"üì± –¢–µ–ª–µ—Ñ–æ–Ω: {phone}")
    
    if session:
        print(f"‚úÖ –°—Ç–∞—Ç—É—Å: –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω")
        print(f"\nüë§ –ò–º—è: –ò–≤–∞–Ω (–ø—Ä–∏–º–µ—Ä)")
        print(f"üë§ –§–∞–º–∏–ª–∏—è: –ü–µ—Ç—Ä–æ–≤ (–ø—Ä–∏–º–µ—Ä)")
        print(f"üîó Username: @example (–ø—Ä–∏–º–µ—Ä)")
        print(f"üìù –ë–∏–æ: Digital Marketing üåê (–ø—Ä–∏–º–µ—Ä)")
    else:
        print(f"‚ùå –°—Ç–∞—Ç—É—Å: –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω")
        print(f"\n‚ö†Ô∏è –≠—Ç–æ—Ç –∞–∫–∫–∞—É–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω—ë–Ω.")
    
    print(f"\n{'='*60}")
    print("–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:")
    print("  [üì∑ –ê–≤–∞—Ç–∞—Ä–∫–∞]")
    print("  [üë§ –ò–º—è –∏ –§–∞–º–∏–ª–∏—è]")
    print("  [üìù –û —Å–µ–±–µ (–ë–∏–æ)]")
    print("  [‚óÄÔ∏è –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É]")
    print("  [üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é]")
    print(f"{'='*60}\n")

def main():
    """
    –ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    """
    print("\n" + "="*60)
    print(" üéØ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –°–ò–°–¢–ï–ú–´ –£–ü–†–ê–í–õ–ï–ù–ò–Ø –ü–†–û–§–ò–õ–Ø–ú–ò")
    print("="*60 + "\n")
    
    # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –æ–∫—Ä—É–∂–µ–Ω–∏—è
    test_data = setup_test_env()
    
    # –ü–æ–ª—É—á–∞–µ–º –∞–∫–∫–∞—É–Ω—Ç—ã
    print("\nüìä –ü–æ–ª—É—á–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏–∑ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è...")
    accounts = get_all_accounts_from_env()
    print(f"‚úÖ –ù–∞–π–¥–µ–Ω–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: {len(accounts)}")
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
    print("\nüìÑ –°–¢–†–ê–ù–ò–¶–ê 1 (–∞–∫–∫–∞—É–Ω—Ç—ã 1-5):")
    display_accounts_keyboard(accounts, page=0, per_page=5)
    
    # –ï—Å–ª–∏ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –±–æ–ª—å—à–µ 5, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
    if len(accounts) > 5:
        print("\nüìÑ –°–¢–†–ê–ù–ò–¶–ê 2 (–∞–∫–∫–∞—É–Ω—Ç—ã 6-10):")
        display_accounts_keyboard(accounts, page=1, per_page=5)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –¥–ª—è –∞–∫–∫–∞—É–Ω—Ç–∞ #1
    print("\nüëÜ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –ê–∫–∫–∞—É–Ω—Ç #1:")
    num, phone, session, proxy = accounts[0]
    display_account_menu(num, phone, session)
    
    # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–µ–Ω—é –¥–ª—è –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
    if len(accounts) > 3:
        print("\nüëÜ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –ê–∫–∫–∞—É–Ω—Ç #4 (–Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω):")
        num, phone, session, proxy = accounts[3]
        display_account_menu(num, phone, session)
    
    # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    print("\nüìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê:")
    print(f"{'='*60}")
    authorized = sum(1 for _, _, s, _ in accounts if s)
    with_proxy = sum(1 for _, _, _, p in accounts if p)
    print(f"  –í—Å–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤: {len(accounts)}")
    print(f"  –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ: {authorized}")
    print(f"  –° –ø—Ä–æ–∫—Å–∏: {with_proxy}")
    print(f"  –ù–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–æ: {len(accounts) - authorized}")
    print(f"{'='*60}\n")
    
    # –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è
    print("\nüé¨ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ü–†–û–¶–ï–°–°–ê –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ê–í–ê–¢–ê–†–ö–ò:")
    print(f"{'='*60}")
    print("1Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç [üì∑ –ê–≤–∞—Ç–∞—Ä–∫–∞]")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ñ–æ—Ç–æ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–∫–∏'")
    print("\n2Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...'")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚úÖ –§–æ—Ç–æ –≤—ã–±—Ä–∞–Ω–æ! –ü—Ä–∏–º–µ–Ω–∏—Ç—å?'")
    print("\n3Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç [‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å]")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏...'")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚úÖ –ê–≤–∞—Ç–∞—Ä–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞'")
    print(f"{'='*60}\n")
    
    print("\nüé¨ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ü–†–û–¶–ï–°–°–ê –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ò–ú–ï–ù–ò:")
    print(f"{'='*60}")
    print("1Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç [üë§ –ò–º—è –∏ –§–∞–º–∏–ª–∏—è]")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ñ–∞–º–∏–ª–∏—é —á–µ—Ä–µ–∑ –ø—Ä–æ–±–µ–ª'")
    print("\n2Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç: '–ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤'")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '–ò–º—è: –ê–ª–µ–∫—Å–µ–π'")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '–§–∞–º–∏–ª–∏—è: –°–º–∏—Ä–Ω–æ–≤'")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '–ü—Ä–∏–º–µ–Ω–∏—Ç—å?'")
    print("\n3Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç [‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å]")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–º–µ–Ω–∏...'")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚úÖ –ò–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–æ: –ê–ª–µ–∫—Å–µ–π –°–º–∏—Ä–Ω–æ–≤'")
    print(f"{'='*60}\n")
    
    print("\nüé¨ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ü–†–û–¶–ï–°–°–ê –ò–ó–ú–ï–ù–ï–ù–ò–Ø –ë–ò–û:")
    print(f"{'='*60}")
    print("1Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç [üìù –û —Å–µ–±–µ (–ë–∏–æ)]")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Å–µ–±–µ'")
    print("\n2Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–≤–æ–¥–∏—Ç:")
    print("   'Software Developer üíª'")
    print("   'Python | JavaScript | Go'")
    print("   'üåê https://mywebsite.com'")
    print("\n3Ô∏è‚É£ –ë–æ—Ç –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–µ–≤—å—é –∏ —Å–ø—Ä–∞—à–∏–≤–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ")
    print("\n4Ô∏è‚É£ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç [‚úÖ –ü—Ä–∏–º–µ–Ω–∏—Ç—å]")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚è≥ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∏–æ...'")
    print("   ‚îî‚îÄ> –ë–æ—Ç: '‚úÖ –ë–∏–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ'")
    print(f"{'='*60}\n")
    
    print("\n‚úÖ –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–Ø –ó–ê–í–ï–†–®–ï–ù–ê!")
    print("="*60)
    print("üìö –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: ACCOUNTS_PROFILES_GUIDE.md")
    print("‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: QUICK_PROFILES.md")
    print("="*60 + "\n")

if __name__ == "__main__":
    main()
