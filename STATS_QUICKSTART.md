# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω–æ–π /stats

## –®–∞–≥ 1: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å
pkill -f main.py

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç–∞ –∑–∞–Ω–æ–≤–æ
python3 main.py
```

–ü—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—É—Å–∫–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç—Å—è –Ω–æ–≤–∞—è —Ç–∞–±–ª–∏—Ü–∞ `account_stats` —Å –∏–Ω–¥–µ–∫—Å–∞–º–∏.

## –®–∞–≥ 2: –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ï—Å–ª–∏ —É –≤–∞—Å —É–∂–µ –µ—Å—Ç—å –∏—Å—Ç–æ—Ä–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –µ—ë –≤ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:

```bash
python3 migrate_stats.py
```

–°–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∂–µ—Ç:
- ‚úÖ –°–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π –Ω–∞–π–¥–µ–Ω–æ
- ‚úÖ –°–∫–æ–ª—å–∫–æ —É—Å–ø–µ—à–Ω–æ –º–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ
- ‚úÖ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏ –∫–∞–Ω–∞–ª–æ–≤

## –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤—É—é –∫–æ–º–∞–Ω–¥—É
–û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –∫–æ–º–∞–Ω–¥—É:
```
/stats
```

–í—ã —É–≤–∏–¥–∏—Ç–µ –ø–æ–ª–Ω—ã–π —É–ø—Ä–∞–≤–ª–µ–Ω—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç —Å–æ –≤—Å–µ–º–∏ –Ω–æ–≤—ã–º–∏ –±–ª–æ–∫–∞–º–∏.

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –Ω–∞–∫–æ–ø–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
–° —ç—Ç–æ–≥–æ –º–æ–º–µ–Ω—Ç–∞ –∫–∞–∂–¥–æ–µ —Å–æ–±—ã—Ç–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è:
- ‚úÖ –ö–∞–∂–¥—ã–π –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
- ‚ùå –ö–∞–∂–¥–∞—è –æ—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
- üö´ –ö–∞–∂–¥–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
–ù–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è:
1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏** –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
2. **–í—ã—è–≤–ª–µ–Ω–∏—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –∫–∞–Ω–∞–ª–æ–≤** —Å –≤—ã—Å–æ–∫–∏–º % –æ—à–∏–±–æ–∫
3. **–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ —Ä–∏—Å–∫–∞—Ö** (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∏, –ø—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–æ–≤)
4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è** –Ω–∞–≥—Ä—É–∑–∫–∏ –º–µ–∂–¥—É –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏

### –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

**–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ `/stats` –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑ –≤ –¥–µ–Ω—å
- –û–±—Ä–∞—â–∞–π—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è (‚ö†Ô∏è)
- –°–ª–µ–¥–∏—Ç–µ –∑–∞ –±–∞–ª–∞–Ω—Å–æ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –º–µ–∂–¥—É –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏

**–ü—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–π:**
- üî¥ **–ü–æ–≤—ã—à–µ–Ω–Ω–æ–µ —á–∏—Å–ª–æ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫** ‚Üí —Å–Ω–∏–∑—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å `/setspeed`
- üî¥ **–í—ã—Å–æ–∫–∏–π % –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫** ‚Üí –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
- üî¥ **–ü—Ä–∏–±–ª–∏–∂–µ–Ω–∏–µ –∫ –ª–∏–º–∏—Ç—É** ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –±–æ–ª—å—à–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏–ª–∏ —Å–Ω–∏–∑—å—Ç–µ —Å–∫–æ—Ä–æ—Å—Ç—å

**–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è:**
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/setname`, `/setbio`, `/setavatar` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ—Ñ–∏–ª–µ–π –≤—Å–µ—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ (—Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ –≤—Å–µ–º–∏, –Ω–µ —Ç–æ–ª—å–∫–æ –∞–∫—Ç–∏–≤–Ω—ã–º–∏)
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ —Ç–æ–ø-–∫–∞–Ω–∞–ª—ã –∏ —Ñ–æ–∫—É—Å–∏—Ä—É–π—Ç–µ—Å—å –Ω–∞ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã—Ö
- –†–æ—Ç–∏—Ä—É–π—Ç–µ –∞–∫–∫–∞—É–Ω—Ç—ã –ø—Ä–∏ –ø–æ—è–≤–ª–µ–Ω–∏–∏ –±–æ–ª—å—à–æ–≥–æ —á–∏—Å–ª–∞ –æ—à–∏–±–æ–∫

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã –º–∏–≥—Ä–∞—Ü–∏–∏

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:

```bash
sqlite3 bot_data.db "SELECT COUNT(*) FROM account_stats;"
sqlite3 bot_data.db "SELECT COUNT(DISTINCT phone) FROM account_stats;"
sqlite3 bot_data.db "SELECT event_type, COUNT(*) FROM account_stats GROUP BY event_type;"
```

## Troubleshooting

### –¢–∞–±–ª–∏—Ü–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
–ï—Å–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç –æ—à–∏–±–∫–∞ "table already exists" ‚Äî —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ, —Ç–∞–±–ª–∏—Ü–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.

### –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –Ω–∞—Ö–æ–¥–∏—Ç –¥–∞–Ω–Ω—ã—Ö
–ï—Å–ª–∏ `migrate_stats.py` —Å–æ–æ–±—â–∞–µ—Ç "No data in comment_history" ‚Äî –∑–Ω–∞—á–∏—Ç —É –≤–∞—Å –Ω–µ—Ç —Å—Ç–∞—Ä–æ–π –∏—Å—Ç–æ—Ä–∏–∏, –∏ –º–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –Ω—É–∂–Ω–∞. –ù–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞—á–Ω—ë—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è —Å —Ç–µ–∫—É—â–µ–≥–æ –º–æ–º–µ–Ω—Ç–∞.

### –û—à–∏–±–∫–∏ –ë–î –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ
–ï—Å–ª–∏ –≤–æ–∑–Ω–∏–∫–∞—é—Ç –æ—à–∏–±–∫–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö:
```bash
# –°–¥–µ–ª–∞—Ç—å –±—ç–∫–∞–ø
cp bot_data.db bot_data.db.backup

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç—å
sqlite3 bot_data.db "PRAGMA integrity_check;"
```

## –û–±—Ä–∞—Ç–Ω–∞—è —Å–≤—è–∑—å
–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –æ–±—Ä–∞—Ç–Ω–æ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–µ —Ç–∞–∫:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –±–æ—Ç–∞
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –±–æ—Ç –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ–∞–π–ª—É –ë–î
