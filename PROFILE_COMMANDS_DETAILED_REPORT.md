# üìã –î–ï–¢–ê–õ–¨–ù–´–ô –û–¢–ß–ï–¢: PROFILE COMMANDS
## /setname, /setbio, /setavatar

---

## üìç –ú–ï–°–¢–û–ü–û–õ–û–ñ–ï–ù–ò–ï –í –ö–û–î–ï

### 1Ô∏è‚É£ /setname - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –∏–º–µ–Ω–∏
**–°—Ç—Ä–æ–∫–∏:** 4007-4062 (main.py)

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã:**
```python
@self.bot_client.on(events.NewMessage(pattern='/setname'))
async def setname_command(event):
```

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ –≤–≤–æ–¥–∞ –∏–º–µ–Ω–∏:**
–°—Ç—Ä–æ–∫–∏ 4250-4420 (main.py) - –≤–Ω—É—Ç—Ä–∏ `handle_profile_input()`

---

### 2Ô∏è‚É£ /setbio - –ò–∑–º–µ–Ω–µ–Ω–∏–µ –±–∏–æ/–æ–ø–∏—Å–∞–Ω–∏—è
**–°—Ç—Ä–æ–∫–∏:** 4064-4118 (main.py)

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã:**
```python
@self.bot_client.on(events.NewMessage(pattern='/setbio'))
async def setbio_command(event):
```

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤—ã–±–æ—Ä–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –∏ –≤–≤–æ–¥–∞ –±–∏–æ:**
–°—Ç—Ä–æ–∫–∏ 4421-4530 (main.py) - –≤–Ω—É—Ç—Ä–∏ `handle_profile_input()`

---

### 3Ô∏è‚É£ /setavatar - –ó–∞–≥—Ä—É–∑–∫–∞ –∞–≤–∞—Ç–∞—Ä–∫–∏
**–°—Ç—Ä–æ–∫–∏:** 4120-4175 (main.py)

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ–º–∞–Ω–¥—ã:**
```python
@self.bot_client.on(events.NewMessage(pattern='/setavatar'))
async def setavatar_command(event):
```

**–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–æ—Ç–æ:**
–°—Ç—Ä–æ–∫–∏ 4532-4650 (main.py) - –≤–Ω—É—Ç—Ä–∏ `handle_avatar_photo()`

---

## üîß –ò–ó–ú–ï–ù–ï–ù–ò–Ø, –ö–û–¢–û–†–´–ï –ë–´–õ–ò –í–ù–ï–°–ï–ù–´

### ‚úÖ –ë–´–õ–û (–¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π):
1. **–ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞** - –∞–∫–∫–∞—É–Ω—Ç—ã –º–æ–≥–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –≤ —Ä–∞–∑–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
2. **–ù–µ—Ç —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –ø–æ admin_id** - –≤—Å–µ –∞–¥–º–∏–Ω—ã –≤–∏–¥–µ–ª–∏ –≤—Å–µ –∞–∫–∫–∞—É–Ω—Ç—ã
3. **–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ** - —Å–ª–æ–∂–Ω–æ –æ—Ç—Å–ª–µ–¥–∏—Ç—å –∫–∞–∫–æ–π –∞–∫–∫–∞—É–Ω—Ç —Ä–µ–∞–ª—å–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è
4. **–ù–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å—Ç–∞—Ç—É—Å–∞** - –º–æ–≥–ª–∏ –≤—ã–±—Ä–∞—Ç—å broken –∞–∫–∫–∞—É–Ω—Ç
5. **–†–∏—Å–∫ –ø–µ—Ä–µ–ø—É—Ç–∞—Ç—å –∞–∫–∫–∞—É–Ω—Ç—ã** - –Ω–µ—Ç –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ —Ç—Ä–µ–∫–∏–Ω–≥–∞ phone ‚Üí client

### ‚úÖ –°–¢–ê–õ–û (–ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π):

#### 1. –ï–¥–∏–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ (–∫–∞–∫ –≤ /listaccounts)
```python
# Determine admin_id for filtering (same as /listaccounts)
admin_id = self.get_admin_id(event.sender_id)

# Filter accounts by admin_id
if admin_id is None:  # Super admin - show all
    filtered_accounts = self.accounts_data
else:  # Regular admin - show only their accounts
    filtered_accounts = {phone: data for phone, data in self.accounts_data.items()
                       if data.get('admin_id') == admin_id}
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ö–∞–∂–¥—ã–π –∞–¥–º–∏–Ω –≤–∏–¥–∏—Ç —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∞–∫–∫–∞—É–Ω—Ç—ã

#### 2. –°—Ç–∞–±–∏–ª—å–Ω–∞—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (sorted())
```python
# Get accounts with sessions only, sorted for stable order
all_accounts = [(phone, data) for phone, data in sorted(filtered_accounts.items()) 
                if data.get('session')]
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ü–æ—Ä—è–¥–æ–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ò–î–ï–ù–¢–ò–ß–ï–ù /listaccounts

#### 3. –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã —Å—Ç–∞—Ç—É—Å–∞ (–∫–∞–∫ –≤ /listaccounts)
```python
for idx, (phone, data) in enumerate(all_accounts, 1):
    # Get status indicator like in /listaccounts
    status_val = data.get('status', ACCOUNT_STATUS_RESERVE)
    if status_val == ACCOUNT_STATUS_ACTIVE:
        status = "‚úÖ"
    elif status_val == ACCOUNT_STATUS_BROKEN:
        status = "üî¥"
    else:
        status = "üîµ"
    
    text += f"{idx}. {status} `{phone}`\n"
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –í–∏–∑—É–∞–ª—å–Ω–æ –≤–∏–¥–Ω–æ —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

#### 4. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ PROFILE UPDATE
```python
# –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–∫–∫–∞—É–Ω—Ç–∞:
logger.info(f"PROFILE UPDATE: Account selected - index={account_num}, phone={selected_phone}, "
           f"status={selected_data.get('status')}, admin_id={selected_data.get('admin_id')}, "
           f"has_session={bool(selected_data.get('session'))}")

# –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–ª–∏–µ–Ω—Ç–∞:
logger.info(f"PROFILE UPDATE: Creating client for phone={phone}")
logger.info(f"PROFILE UPDATE: Connecting client for phone={phone}")
logger.info(f"PROFILE UPDATE: Checking authorization for phone={phone}")

# –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏:
logger.info(f"PROFILE UPDATE: SUCCESS - Name updated for phone={phone} from '{old_name}' to '{new_name}'")
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –≤—Å–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞

#### 5. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
```python
# –°–æ—Ö—Ä–∞–Ω—è–µ–º phone –∏ data –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–∫–∫–∞—É–Ω—Ç–∞
self.user_states[event.sender_id] = {
    'state': 'waiting_name_input',
    'phone': selected_phone,      # –ö–û–ù–ö–†–ï–¢–ù–´–ô —Ç–µ–ª–µ—Ñ–æ–Ω
    'data': selected_data          # –ö–û–ù–ö–†–ï–¢–ù–ê–Ø —Å–µ—Å—Å–∏—è
}

# –ü–æ–∑–∂–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º –≠–¢–£ –ñ–ï —Å–µ—Å—Å–∏—é:
client = TelegramClient(
    StringSession(data['session']),  # –°–µ—Å—Å–∏—è –í–´–ë–†–ê–ù–ù–û–ì–û –∞–∫–∫–∞—É–Ω—Ç–∞
    API_ID, 
    API_HASH,
    proxy=data.get('proxy')          # –ü—Ä–æ–∫—Å–∏ –í–´–ë–†–ê–ù–ù–û–ì–û –∞–∫–∫–∞—É–Ω—Ç–∞
)
```
**–≠—Ñ—Ñ–µ–∫—Ç:** –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –ü–†–ê–í–ò–õ–¨–ù–û–ú–£ –∞–∫–∫–∞—É–Ω—Ç—É

---

## ‚úÖ –ì–ê–†–ê–ù–¢–ò–ò –ü–†–ê–í–ò–õ–¨–ù–û–°–¢–ò

### 1. –°–ø–∏—Å–æ–∫ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å /listaccounts

#### /listaccounts (—Å—Ç—Ä–æ–∫–∏ 1550-1600):
```python
# Filter accounts by admin_id
if admin_id is None:
    filtered_accounts = self.accounts_data
else:
    filtered_accounts = {phone: data for phone, data in self.accounts_data.items()
                       if data.get('admin_id') == admin_id}

# Display with status
status_val = data.get('status', ACCOUNT_STATUS_RESERVE)
if status_val == ACCOUNT_STATUS_ACTIVE:
    status = "‚úÖ ACTIVE"
```

#### Profile commands (—Å—Ç—Ä–æ–∫–∏ 4007+):
```python
# –ò–î–ï–ù–¢–ò–ß–ù–ê–Ø –ª–æ–≥–∏–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏
if admin_id is None:
    filtered_accounts = self.accounts_data
else:
    filtered_accounts = {phone: data for phone, data in self.accounts_data.items()
                       if data.get('admin_id') == admin_id}

# –ò–î–ï–ù–¢–ò–ß–ù–ê–Ø –ª–æ–≥–∏–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
status_val = data.get('status', ACCOUNT_STATUS_RESERVE)
if status_val == ACCOUNT_STATUS_ACTIVE:
    status = "‚úÖ"
```

#### –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞:
- **\listaccounts:** `accounts_list = list(filtered_accounts.items())`
- **Profile commands:** `all_accounts = [(phone, data) for phone, data in sorted(filtered_accounts.items())]`

**‚ö†Ô∏è –í–ê–ñ–ù–û:** Profile commands –∏—Å–ø–æ–ª—å–∑—É—é—Ç `sorted()` –¥–ª—è –°–¢–ê–ë–ò–õ–¨–ù–û–°–¢–ò –ø–æ—Ä—è–¥–∫–∞!

---

### 2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞

#### –¢—Ä–µ—Ö—ç—Ç–∞–ø–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞:

**–≠—Ç–∞–ø 1: –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—ã–±–æ—Ä–∞**
```python
# –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±—Ä–∞–ª –∞–∫–∫–∞—É–Ω—Ç #2
selected_phone, selected_data = accounts[account_num - 1]

# –°–æ—Ö—Ä–∞–Ω—è–µ–º –ò–ú–ï–ù–ù–û –≠–¢–û–¢ —Ç–µ–ª–µ—Ñ–æ–Ω –∏ –ò–ú–ï–ù–ù–û –≠–¢–£ —Å–µ—Å—Å–∏—é
self.user_states[event.sender_id] = {
    'phone': selected_phone,
    'data': selected_data
}
```

**–≠—Ç–∞–ø 2: –°–æ–∑–¥–∞–Ω–∏–µ –∫–ª–∏–µ–Ω—Ç–∞**
```python
# –ë–µ—Ä–µ–º phone –∏ data –∏–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
phone = state_data.get('phone')      # +79123456789 (—Ç–æ—Ç —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏)
data = state_data.get('data')        # {'session': '...', 'proxy': {...}}

# –°–æ–∑–¥–∞–µ–º –∫–ª–∏–µ–Ω—Ç —Å –≠–¢–û–ô —Å–µ—Å—Å–∏–µ–π
client = TelegramClient(
    StringSession(data['session']),  # –°–ï–°–°–ò–Ø –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
    API_ID, 
    API_HASH,
    proxy=data.get('proxy')          # –ü–†–û–ö–°–ò –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
)
```

**–≠—Ç–∞–ø 3: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏**
```python
logger.info(f"PROFILE UPDATE: Creating client for phone={phone}")
# –í—ã–≤–æ–¥: PROFILE UPDATE: Creating client for phone=+79123456789

logger.info(f"PROFILE UPDATE: SUCCESS - Name updated for phone={phone}")
# –í—ã–≤–æ–¥: PROFILE UPDATE: SUCCESS - Name updated for phone=+79123456789
```

#### –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ª–æ–≥–∏:
```bash
tail -f bot.log | grep "PROFILE UPDATE"
```

–î–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Ü–µ–ø–æ—á–∫–∞:
```
PROFILE UPDATE: Account selected - index=2, phone=+79123456789
PROFILE UPDATE: Creating client for phone=+79123456789
PROFILE UPDATE: Connecting client for phone=+79123456789
PROFILE UPDATE: SUCCESS - Name updated for phone=+79123456789
```

**–ï—Å–ª–∏ phone —Å–æ–≤–ø–∞–¥–∞–µ—Ç –≤–æ –í–°–ï–• —Å–æ–æ–±—â–µ–Ω–∏—è—Ö ‚Üí –∫–ª–∏–µ–Ω—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π!**

---

## üß™ –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨ –†–£–ö–ê–ú–ò

### –¢–µ—Å—Ç 1: –°–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Å–ø–∏—Å–∫–æ–≤

**–®–∞–≥ 1:** –û—Ç–ø—Ä–∞–≤—å `/listaccounts`
```
–ê–ö–ö–ê–£–ù–¢–´ (4):
1. ‚úÖ ACTIVE `Ivan` (@ivan123)
   `+79111111111`
2. üîµ RESERVE `Petr` (@petr456)
   `+79222222222`
3. ‚úÖ ACTIVE `Anna` (@anna789)
   `+79333333333`
4. üî¥ BROKEN `Test` (@test000)
   `+79444444444`
```

**–®–∞–≥ 2:** –û—Ç–ø—Ä–∞–≤—å `/setname`
```
üë§ –ò–ó–ú–ï–ù–ï–ù–ò–ï –ò–ú–ï–ù–ò

–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∞–∫–∫–∞—É–Ω—Ç–∞:

1. ‚úÖ `+79111111111`
2. üîµ `+79222222222`
3. ‚úÖ `+79333333333`
4. üî¥ `+79444444444`
```

**‚úÖ –ü–†–û–í–ï–†–¨:**
- –û–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ —Å—Ç–∞—Ç—É—Å—ã (‚úÖüîµüî¥)
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–π –ø–æ—Ä—è–¥–æ–∫ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
- –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –Ω–æ–º–µ—Ä–∞ (1, 2, 3, 4)

---

### –¢–µ—Å—Ç 2: –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∏–∑–º–µ–Ω—è–µ—Ç—Å—è

**–®–∞–≥ 1:** –ó–∞–ø–æ–º–Ω–∏ –∫–∞–∫–æ–π –∞–∫–∫–∞—É–Ω—Ç –ø–æ–¥ –∫–∞–∫–∏–º –Ω–æ–º–µ—Ä–æ–º
```
/listaccounts
1. ‚úÖ ACTIVE `Ivan` (@ivan123) `+79111111111`
2. üîµ RESERVE `Petr` (@petr456) `+79222222222`
```

**–®–∞–≥ 2:** –û—Ç–ø—Ä–∞–≤—å `/setname`
```
–í—ã–±–µ—Ä–∏—Ç–µ –Ω–æ–º–µ—Ä –∞–∫–∫–∞—É–Ω—Ç–∞:
1. ‚úÖ `+79111111111`
2. üîµ `+79222222222`
```

**–®–∞–≥ 3:** –û—Ç–≤–µ—Ç—å `2` (–≤—ã–±–∏—Ä–∞–µ–º Petr)

**–®–∞–≥ 4:** –û—Ç–ø—Ä–∞–≤—å –Ω–æ–≤–æ–µ –∏–º—è: `Petr Updated`

**–®–∞–≥ 5:** –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:
```bash
tail -20 bot.log | grep "PROFILE UPDATE"
```

**‚úÖ –î–û–õ–ñ–ù–û –ë–´–¢–¨:**
```
PROFILE UPDATE: Account selected - index=2, phone=+79222222222
PROFILE UPDATE: Creating client for phone=+79222222222
PROFILE UPDATE: Connecting client for phone=+79222222222
PROFILE UPDATE: Current name for +79222222222: 'Petr'
PROFILE UPDATE: SUCCESS - Name updated for phone=+79222222222
```

**‚úÖ –ö–†–ò–¢–ï–†–ò–ô:** –í–µ–∑–¥–µ phone=+79222222222 (—Ç–æ—Ç —á—Ç–æ –≤—ã–±—Ä–∞–ª–∏!)

**–®–∞–≥ 6:** –ü—Ä–æ–≤–µ—Ä—å –≤ Telegram
- –û—Ç–∫—Ä–æ–π –ø—Ä–æ—Ñ–∏–ª—å –∞–∫–∫–∞—É–Ω—Ç–∞ +79222222222
- –ò–º—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å "Petr Updated"
- –ê–∫–∫–∞—É–Ω—Ç +79111111111 –ù–ï –¥–æ–ª–∂–µ–Ω –∏–∑–º–µ–Ω–∏—Ç—å—Å—è

---

### –¢–µ—Å—Ç 3: /setbio —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π

**–®–∞–≥ 1:** `/setbio` ‚Üí –≤—ã–±–µ—Ä–∏ –∞–∫–∫–∞—É–Ω—Ç #1
**–®–∞–≥ 2:** –û—Ç–ø—Ä–∞–≤—å –±–∏–æ: `Crypto trader üöÄ`
**–®–∞–≥ 3:** –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:
```
PROFILE UPDATE: Account selected - index=1, phone=+79111111111
PROFILE UPDATE: SUCCESS - Bio updated for phone=+79111111111
```
**–®–∞–≥ 4:** –û—Ç–∫—Ä–æ–π –∞–∫–∫–∞—É–Ω—Ç +79111111111 –≤ Telegram
**–®–∞–≥ 5:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –±–∏–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å –Ω–∞ "Crypto trader üöÄ"

---

### –¢–µ—Å—Ç 4: /setavatar —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π

**–®–∞–≥ 1:** `/setavatar` ‚Üí –≤—ã–±–µ—Ä–∏ –∞–∫–∫–∞—É–Ω—Ç #3
**–®–∞–≥ 2:** –û—Ç–ø—Ä–∞–≤—å —Ñ–æ—Ç–æ
**–®–∞–≥ 3:** –ü—Ä–æ–≤–µ—Ä—å –ª–æ–≥–∏:
```
PROFILE UPDATE: Account selected - index=3, phone=+79333333333
PROFILE UPDATE: Downloading photo for phone=+79333333333
PROFILE UPDATE: SUCCESS - Avatar uploaded for phone=+79333333333
```
**–®–∞–≥ 4:** –û—Ç–∫—Ä–æ–π –∞–∫–∫–∞—É–Ω—Ç +79333333333 –≤ Telegram
**–®–∞–≥ 5:** –ü—Ä–æ–≤–µ—Ä—å —á—Ç–æ –∞–≤–∞—Ç–∞—Ä–∫–∞ –∏–∑–º–µ–Ω–∏–ª–∞—Å—å

---

## üîç –î–ï–¢–ê–õ–ò –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### –ú–µ—Ö–∞–Ω–∏–∑–º user_states

**–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è /setname:**
1. `waiting_account_selection_for_name` - –∂–¥–µ–º –Ω–æ–º–µ—Ä –∞–∫–∫–∞—É–Ω—Ç–∞
2. `waiting_name_input` - –∂–¥–µ–º –Ω–æ–≤–æ–µ –∏–º—è

**–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è /setbio:**
1. `waiting_account_selection_for_bio` - –∂–¥–µ–º –Ω–æ–º–µ—Ä –∞–∫–∫–∞—É–Ω—Ç–∞
2. `waiting_bio_input` - –∂–¥–µ–º –Ω–æ–≤–æ–µ –±–∏–æ

**–°–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è /setavatar:**
1. `waiting_account_selection_for_avatar` - –∂–¥–µ–º –Ω–æ–º–µ—Ä –∞–∫–∫–∞—É–Ω—Ç–∞
2. `waiting_avatar_photo` - –∂–¥–µ–º —Ñ–æ—Ç–æ

### –î–∞–Ω–Ω—ã–µ –≤ user_states

```python
self.user_states[event.sender_id] = {
    'state': 'waiting_name_input',
    'phone': '+79222222222',          # –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ç–µ–ª–µ—Ñ–æ–Ω
    'data': {                          # –î–∞–Ω–Ω—ã–µ –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
        'session': 'base64_session',
        'proxy': {...},
        'status': 'active',
        'admin_id': 123
    }
}
```

**–ì–∞—Ä–∞–Ω—Ç–∏—è:** phone –∏ data –§–ò–ö–°–ò–†–£–Æ–¢–°–Ø –ø—Ä–∏ –≤—ã–±–æ—Ä–µ –∏ –Ω–µ –º–µ–Ω—è—é—Ç—Å—è –¥–æ –∫–æ–Ω—Ü–∞ –æ–ø–µ—Ä–∞—Ü–∏–∏

---

## üìä –°–¢–†–£–ö–¢–£–†–ê –í–´–ó–û–í–û–í

### /setname - –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª:

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 1. /setname                                     ‚îÇ
‚îÇ    ‚Üí setname_command()                          ‚îÇ
‚îÇ    ‚Üí –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ admin_id                    ‚îÇ
‚îÇ    ‚Üí sorted(filtered_accounts.items())          ‚îÇ
‚îÇ    ‚Üí –ü–æ–∫–∞–∑ —Å–ø–∏—Å–∫–∞ —Å ‚úÖüîµüî¥                      ‚îÇ
‚îÇ    ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ state –∏ all_accounts           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 2. User: "2"                                    ‚îÇ
‚îÇ    ‚Üí handle_profile_input()                     ‚îÇ
‚îÇ    ‚Üí accounts[account_num - 1]                  ‚îÇ
‚îÇ    ‚Üí selected_phone, selected_data             ‚îÇ
‚îÇ    ‚Üí LOG: Account selected - index=2, phone=... ‚îÇ
‚îÇ    ‚Üí –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ phone –∏ data –≤ user_states     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                    ‚Üì
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ 3. User: "Ivan Petrov"                          ‚îÇ
‚îÇ    ‚Üí handle_profile_input()                     ‚îÇ
‚îÇ    ‚Üí –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ phone –∏ data –∏–∑ user_states    ‚îÇ
‚îÇ    ‚Üí LOG: Creating client for phone=...        ‚îÇ
‚îÇ    ‚Üí TelegramClient(StringSession(data['session'])) ‚îÇ
‚îÇ    ‚Üí await client.connect()                     ‚îÇ
‚îÇ    ‚Üí LOG: Connecting client for phone=...      ‚îÇ
‚îÇ    ‚Üí await client(UpdateProfileRequest(...))    ‚îÇ
‚îÇ    ‚Üí LOG: SUCCESS - Name updated for phone=... ‚îÇ
‚îÇ    ‚Üí await client.disconnect()                  ‚îÇ
‚îÇ    ‚Üí Clear user_states                          ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ö–ª—é—á–µ–≤–æ–π –º–æ–º–µ–Ω—Ç:** phone –ø—Ä–æ—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –í–°–ï —ç—Ç–∞–ø—ã –∏ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –≤–µ–∑–¥–µ

---

## üéØ –ö–õ–Æ–ß–ï–í–´–ï –í–´–í–û–î–´

### ‚úÖ –ß–¢–û –ì–ê–†–ê–ù–¢–ò–†–£–ï–¢–°–Ø:

1. **–°–ø–∏—Å–∫–∏ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã /listaccounts:**
   - –¢–∞ –∂–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ admin_id
   - –¢–µ –∂–µ —Å—Ç–∞—Ç—É—Å—ã (‚úÖüîµüî¥)
   - sorted() –¥–ª—è —Å—Ç–∞–±–∏–ª—å–Ω–æ–≥–æ –ø–æ—Ä—è–¥–∫–∞

2. **–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª–∏–µ–Ω—Ç –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞:**
   - phone –∏ data —Ñ–∏–∫—Å–∏—Ä—É—é—Ç—Å—è –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
   - TelegramClient —Å–æ–∑–¥–∞–µ—Ç—Å—è —Å —Å–µ—Å—Å–∏–µ–π –í–´–ë–†–ê–ù–ù–û–ì–û –∞–∫–∫–∞—É–Ω—Ç–∞
   - phone –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è –Ω–∞ –ö–ê–ñ–î–û–ú —ç—Ç–∞–ø–µ
   - –ú–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á–µ—Ä–µ–∑ –ª–æ–≥–∏

3. **–ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞:**
   - "PROFILE UPDATE:" –º–∞—Ä–∫–µ—Ä –¥–ª—è –ø–æ–∏—Å–∫–∞
   - –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç: index, phone, status, admin_id, has_session
   - –ö–∞–∂–¥—ã–π —à–∞–≥ (—Å–æ–∑–¥–∞–Ω–∏–µ, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ) –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è
   - –û—à–∏–±–∫–∏ —Å –ø–æ–ª–Ω—ã–º traceback

4. **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:**
   - try/except/finally –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
   - Disconnect –≤ finally (–≤—Å–µ–≥–¥–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è)
   - Cleanup –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (–∞–≤–∞—Ç–∞—Ä–∫–∏)
   - Clear user_states –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

---

## üêõ –ö–ê–ö –î–ï–ë–ê–ñ–ò–¢–¨ –ï–°–õ–ò –ß–¢–û-–¢–û –ù–ï –¢–ê–ö

### –ü—Ä–æ–±–ª–µ–º–∞: "–ò–∑–º–µ–Ω–∏–ª—Å—è –Ω–µ —Ç–æ—Ç –∞–∫–∫–∞—É–Ω—Ç"

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```bash
tail -50 bot.log | grep "PROFILE UPDATE"
```

**–°–º–æ—Ç—Ä–∏ –Ω–∞ —Ü–µ–ø–æ—á–∫—É phone:**
```
PROFILE UPDATE: Account selected - index=2, phone=+79222222222
PROFILE UPDATE: Creating client for phone=+79222222222
PROFILE UPDATE: Connecting client for phone=+79222222222
PROFILE UPDATE: SUCCESS - Name updated for phone=+79222222222
```

**–ï—Å–ª–∏ phone –†–ê–ó–ù–´–ï ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–¥–µ (–Ω–æ —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–µ–π—á–∞—Å)**  
**–ï—Å–ª–∏ phone –û–î–ò–ù–ê–ö–û–í–´–ô –Ω–æ —ç—Ç–æ –Ω–µ —Ç–æ—Ç –∞–∫–∫–∞—É–Ω—Ç ‚Üí –ø—Ä–æ–±–ª–µ–º–∞ –≤ —Å–ø–∏—Å–∫–µ (–Ω–æ sorted() —ç—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç)**

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–°–ø–∏—Å–æ–∫ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç /listaccounts"

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
1. –û—Ç–ø—Ä–∞–≤—å `/listaccounts` ‚Üí —Å–∫—Ä–∏–Ω—à–æ—Ç
2. –û—Ç–ø—Ä–∞–≤—å `/setname` ‚Üí —Å–∫—Ä–∏–Ω—à–æ—Ç
3. –°—Ä–∞–≤–Ω–∏:
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
   - –ü–æ—Ä—è–¥–æ–∫ —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤
   - –°—Ç–∞—Ç—É—Å—ã

**–ï—Å–ª–∏ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è ‚Üí –ë–ê–ì (–Ω–æ —ç—Ç–æ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –∫–æ–¥ –ò–î–ï–ù–¢–ò–ß–ù–´–ô)**

---

### –ü—Ä–æ–±–ª–µ–º–∞: "–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏"

**–°–º–æ—Ç—Ä–∏ –Ω–∞ —Ç–∏–ø –æ—à–∏–±–∫–∏:**
```
PROFILE UPDATE: ERROR Type: FloodWaitError
PROFILE UPDATE: ERROR Message: A wait of 60 seconds is required
```

**–í–æ–∑–º–æ–∂–Ω—ã–µ –æ—à–∏–±–∫–∏:**
- `FloodWaitError` ‚Üí Rate limit Telegram, –ø–æ–¥–æ–∂–¥–∏ N —Å–µ–∫—É–Ω–¥
- `SessionExpiredError` ‚Üí –°–µ—Å—Å–∏—è —É—Å—Ç–∞—Ä–µ–ª–∞, –Ω—É–∂–Ω–∞ –ø–µ—Ä–µ–∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è
- `ChannelPrivateError` ‚Üí –ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–∞–Ω–µ–Ω –∏–ª–∏ –Ω–µ—Ç –ø—Ä–∞–≤
- `AuthKeyUnregisteredError` ‚Üí –°–µ—Å—Å–∏—è –Ω–µ–≤–∞–ª–∏–¥–Ω–∞

**–í—Å–µ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —Å –ø–æ–ª–Ω—ã–º traceback!**

---

## üìà –ú–ï–¢–†–ò–ö–ò –ö–ê–ß–ï–°–¢–í–ê

### –ö–æ–¥ –¥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚ùå –õ–æ–≥–∏: –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ
- ‚ùå –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- ‚ùå –ì–∞—Ä–∞–Ω—Ç–∏–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏: –Ω–µ—Ç
- ‚ùå –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å —Å /listaccounts: –Ω–µ –ø—Ä–æ–≤–µ—Ä–µ–Ω–∞

### –ö–æ–¥ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –õ–æ–≥–∏: –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ (10+ —Å–æ–æ–±—â–µ–Ω–∏–π)
- ‚úÖ –¢—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞: phone –≤–µ–∑–¥–µ
- ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏–∏: phone+data —Ñ–∏–∫—Å–∞—Ü–∏—è
- ‚úÖ –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å: 100% (–∏–¥–µ–Ω—Ç–∏—á–Ω—ã–π –∫–æ–¥)

---

## ‚úÖ –§–ò–ù–ê–õ–¨–ù–´–ô –ß–ï–ö–õ–ò–°–¢

–ü–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º –ø—Ä–æ–≤–µ—Ä—å:

- [ ] `/listaccounts` –∏ `/setname` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–ø–∏—Å–æ–∫
- [ ] `/listaccounts` –∏ `/setbio` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–ø–∏—Å–æ–∫
- [ ] `/listaccounts` –∏ `/setavatar` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Å–ø–∏—Å–æ–∫
- [ ] –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –∞–∫–∫–∞—É–Ω—Ç–∞ #N, –ª–æ–≥–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π phone
- [ ] –ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤–∏–¥–Ω—ã –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ
- [ ] –õ–æ–≥–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç "PROFILE UPDATE:" –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö
- [ ] –û—à–∏–±–∫–∏ –Ω–µ –ª–æ–º–∞—é—Ç user_states (Clear –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è)
- [ ] –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã —É–¥–∞–ª—è—é—Ç—Å—è (–∞–≤–∞—Ç–∞—Ä–∫–∏)

**–í—Å–µ —á–µ–∫–ª–∏—Å—Ç—ã ‚úÖ ‚Üí PRODUCTION READY**
