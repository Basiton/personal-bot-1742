#!/usr/bin/env python3
"""
Ğ¢ĞµÑÑ‚ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸ normalize_account_id
"""

def normalize_account_id(phone_or_id):
    """
    ĞŸÑ€ĞµĞ¾Ğ±Ñ€Ğ°Ğ·ÑƒĞµÑ‚ Ğ»ÑĞ±Ğ¾Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ñ‚ĞµĞ»ĞµÑ„Ğ¾Ğ½Ğ° Ğ² ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ ID (ĞºĞ¾Ğ´ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹)
    
    ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹:
    +15178979270 â†’ +1
    +79261234567 â†’ +7
    +442071234567 â†’ +44
    +380991234567 â†’ +380
    +1 â†’ +1 (ÑƒĞ¶Ğµ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹)
    1 â†’ +1
    """
    if not phone_or_id:
        return None
    
    # Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ Ğ¿Ñ€Ğ¾Ğ±ĞµĞ»Ñ‹
    phone_or_id = str(phone_or_id).strip()
    
    # Ğ•ÑĞ»Ğ¸ ÑƒĞ¶Ğµ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ (+1, +7, +44, +380)
    if phone_or_id.startswith('+') and len(phone_or_id) <= 4:
        return phone_or_id
    
    # Ğ•ÑĞ»Ğ¸ Ğ¿Ñ€Ğ¾ÑÑ‚Ğ¾ Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ±ĞµĞ· + (1, 7, 44, 380)
    if phone_or_id.isdigit() and len(phone_or_id) <= 3:
        return f"+{phone_or_id}"
    
    # Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ - Ğ¸Ğ·Ğ²Ğ»ĞµĞºĞ°ĞµĞ¼ ĞºĞ¾Ğ´ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹
    if phone_or_id.startswith('+'):
        digits = phone_or_id[1:]  # Ğ£Ğ±Ğ¸Ñ€Ğ°ĞµĞ¼ +
    else:
        digits = phone_or_id
    
    # ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµĞ¼ ĞºĞ¾Ğ´ ÑÑ‚Ñ€Ğ°Ğ½Ñ‹ Ğ¿Ğ¾ Ğ¿ĞµÑ€Ğ²Ñ‹Ğ¼ Ñ†Ğ¸Ñ„Ñ€Ğ°Ğ¼
    # ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµĞ¼ Ğ² Ğ¿Ğ¾Ñ€ÑĞ´ĞºĞµ: ÑĞ½Ğ°Ñ‡Ğ°Ğ»Ğ° Ğ±Ğ¾Ğ»ĞµĞµ Ğ´Ğ»Ğ¸Ğ½Ğ½Ñ‹Ğµ ĞºĞ¾Ğ´Ñ‹ (3 Ñ†Ğ¸Ñ„Ñ€Ñ‹), Ğ·Ğ°Ñ‚ĞµĞ¼ 2 Ñ†Ğ¸Ñ„Ñ€Ñ‹, Ğ·Ğ°Ñ‚ĞµĞ¼ 1 Ñ†Ğ¸Ñ„Ñ€Ñƒ
    
    # 3-Ñ†Ğ¸Ñ„Ñ€Ğ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ´Ñ‹
    if digits.startswith('380'):  # Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ğ°
        return '+380'
    elif digits.startswith('371'):  # Ğ›Ğ°Ñ‚Ğ²Ğ¸Ñ
        return '+371'
    elif digits.startswith('370'):  # Ğ›Ğ¸Ñ‚Ğ²Ğ°
        return '+370'
    
    # 2-Ñ†Ğ¸Ñ„Ñ€Ğ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ´Ñ‹
    elif digits.startswith('86'):  # ĞšĞ¸Ñ‚Ğ°Ğ¹
        return '+86'
    elif digits.startswith('44'):  # UK
        return '+44'
    elif digits.startswith('49'):  # Ğ“ĞµÑ€Ğ¼Ğ°Ğ½Ğ¸Ñ
        return '+49'
    
    # 1-Ñ†Ğ¸Ñ„Ñ€Ğ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ´Ñ‹
    elif digits.startswith('1'):  # Ğ¡Ğ¨Ğ/ĞšĞ°Ğ½Ğ°Ğ´Ğ°
        return '+1'
    elif digits.startswith(('7', '8')):  # Ğ Ğ¾ÑÑĞ¸Ñ/ĞšĞ°Ğ·Ğ°Ñ…ÑÑ‚Ğ°Ğ½ (8 ÑÑ‚Ğ°Ñ€Ñ‹Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚)
        return '+7'
    # Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ÑĞµĞ¼ Ğ´Ñ€ÑƒĞ³Ğ¸Ğµ ĞºĞ¾Ğ´Ñ‹ ÑÑ‚Ñ€Ğ°Ğ½ Ğ¿Ğ¾ Ğ½ĞµĞ¾Ğ±Ñ…Ğ¾Ğ´Ğ¸Ğ¼Ğ¾ÑÑ‚Ğ¸
    else:
        # ĞĞ±Ñ‰Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°: ĞµÑĞ»Ğ¸ Ğ´Ğ»Ğ¸Ğ½Ğ° > 10, Ğ±ĞµÑ€Ñ‘Ğ¼ 1-3 Ğ¿ĞµÑ€Ğ²Ñ‹Ğµ Ñ†Ğ¸Ñ„Ñ€Ñ‹
        if len(digits) >= 10:
            # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ 3 Ñ†Ğ¸Ñ„Ñ€Ñ‹
            if digits[:3] in ['380', '371', '370']:
                return f"+{digits[:3]}"
            # ĞŸÑ€Ğ¾Ğ±ÑƒĞµĞ¼ 2 Ñ†Ğ¸Ñ„Ñ€Ñ‹
            elif digits[:2] in ['20', '30', '31', '32', '33', '34', '36', '39', '40', '41', '43', '44', '45', '46', '47', '48', '49']:
                return f"+{digits[:2]}"
            # ĞŸĞ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ 1 Ñ†Ğ¸Ñ„Ñ€Ğ°
            else:
                return f"+{digits[0]}"
        
        return f"+{phone_or_id}"

# Ğ¢ĞµÑÑ‚Ğ¾Ğ²Ñ‹Ğµ ÑĞ»ÑƒÑ‡Ğ°Ğ¸
test_cases = [
    # (input, expected_output, description)
    ("+1", "+1", "Ğ£Ğ¶Ğµ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ¡Ğ¨Ğ"),
    ("+7", "+7", "Ğ£Ğ¶Ğµ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ Ğ¾ÑÑĞ¸Ğ¸"),
    ("+44", "+44", "Ğ£Ğ¶Ğµ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ UK"),
    ("+380", "+380", "Ğ£Ğ¶Ğµ ĞºĞ¾Ñ€Ğ¾Ñ‚ĞºĞ¸Ğ¹ Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ‚ Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ñ‹"),
    
    ("1", "+1", "Ğ¦Ğ¸Ñ„Ñ€Ğ° Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° Ğ¡Ğ¨Ğ"),
    ("7", "+7", "Ğ¦Ğ¸Ñ„Ñ€Ğ° Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° Ğ Ğ¾ÑÑĞ¸Ğ¸"),
    ("44", "+44", "Ğ”Ğ²Ğµ Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° UK"),
    ("380", "+380", "Ğ¢Ñ€Ğ¸ Ñ†Ğ¸Ñ„Ñ€Ñ‹ Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ñ‹"),
    
    ("+15178979270", "+1", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¡Ğ¨Ğ"),
    ("+13434919340", "+1", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ¡Ğ¨Ğ 2"),
    ("+79261234567", "+7", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ Ğ¾ÑÑĞ¸Ğ¸"),
    ("+442071234567", "+44", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ UK"),
    ("+380991234567", "+380", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ñ‹"),
    ("+8613812345678", "+86", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ ĞšĞ¸Ñ‚Ğ°Ñ"),
    ("+4915112345678", "+49", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ“ĞµÑ€Ğ¼Ğ°Ğ½Ğ¸Ğ¸"),
    
    ("15178979270", "+1", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° Ğ¡Ğ¨Ğ"),
    ("79261234567", "+7", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° Ğ Ğ¾ÑÑĞ¸Ğ¸"),
    ("442071234567", "+44", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° UK"),
    ("380991234567", "+380", "ĞŸĞ¾Ğ»Ğ½Ñ‹Ğ¹ Ğ½Ğ¾Ğ¼ĞµÑ€ Ğ±ĞµĞ· Ğ¿Ğ»ÑÑĞ° Ğ£ĞºÑ€Ğ°Ğ¸Ğ½Ñ‹"),
]

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print("ğŸ§ª Ğ¢Ğ•Ğ¡Ğ¢Ğ˜Ğ ĞĞ’ĞĞĞ˜Ğ• normalize_account_id")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n")

passed = 0
failed = 0

for input_val, expected, description in test_cases:
    result = normalize_account_id(input_val)
    status = "âœ…" if result == expected else "âŒ"
    
    if result == expected:
        passed += 1
        print(f"{status} {description}")
        print(f"   {input_val} â†’ {result}")
    else:
        failed += 1
        print(f"{status} {description}")
        print(f"   Input:    {input_val}")
        print(f"   Expected: {expected}")
        print(f"   Got:      {result}")
    print()

print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")
print(f"Ğ Ğ•Ğ—Ğ£Ğ›Ğ¬Ğ¢ĞĞ¢Ğ«: {passed} passed, {failed} failed")
print("â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•")

if failed == 0:
    print("\nâœ… Ğ’Ğ¡Ğ• Ğ¢Ğ•Ğ¡Ğ¢Ğ« ĞŸĞ ĞĞ¨Ğ›Ğ˜ Ğ£Ğ¡ĞŸĞ•Ğ¨ĞĞ!")
else:
    print(f"\nâŒ Ğ•Ğ¡Ğ¢Ğ¬ ĞĞ¨Ğ˜Ğ‘ĞšĞ˜: {failed} Ñ‚ĞµÑÑ‚Ğ¾Ğ² Ğ½Ğµ Ğ¿Ñ€Ğ¾ÑˆĞ»Ğ¸")
    exit(1)
