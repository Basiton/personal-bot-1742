# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏ –≤–æ—Ä–∫–µ—Ä–æ–≤ - –æ—Ç—á–µ—Ç

## –î–∞—Ç–∞: 26 —è–Ω–≤–∞—Ä—è 2026

## –ü—Ä–æ–±–ª–µ–º–∞
–í –ª–æ–≥–∞—Ö –±–æ—Ç–∞ —Ä–µ–≥—É–ª—è—Ä–Ω–æ –ø–æ—è–≤–ª—è–ª–∏—Å—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤:
- –û–∂–∏–¥–∞–µ—Ç—Å—è: N –≤–æ—Ä–∫–µ—Ä–æ–≤
- –†–∞–±–æ—Ç–∞–µ—Ç: 1 –≤–æ—Ä–∫–µ—Ä
- –ü—Ä–∏ —É—Å—Ç–∞–Ω–æ–≤–∫–µ 6 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ —Ä–µ–∞–ª—å–Ω–æ —Ä–∞–±–æ—Ç–∞–ª —Ç–æ–ª—å–∫–æ 1

## –ö–æ—Ä–Ω–µ–≤—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç –∂–∏–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –í `health_check_worker()` –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Å—á–µ—Ç:
```python
alive_workers = sum(1 for task in self.active_worker_tasks if not task.done())
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú–µ—Ä—Ç–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã –ù–ï —É–¥–∞–ª—è–ª–∏—Å—å –∏–∑ `self.active_worker_tasks`, –ø–æ—ç—Ç–æ–º—É —Å–ø–∏—Å–æ–∫ —Ä–æ—Å, –Ω–æ —Ä–µ–∞–ª—å–Ω—ã—Ö –∂–∏–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ –±—ã–ª–æ –º–µ–Ω—å—à–µ.

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
- –ù–µ –±—ã–ª–æ –≤–∏–¥–Ω–æ Task ID –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä–æ–≤
- –ù–µ –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–æ, –ø–æ—á–µ–º—É –≤–æ—Ä–∫–µ—Ä –ø–∞–¥–∞–µ—Ç
- –ù–µ—Ç —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∏ –∏—Å–∫–ª—é—á–µ–Ω–∏–π

### 3. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫ –≤ account_worker
- Fatal –æ—à–∏–±–∫–∏ –Ω–µ –ª–æ–≤–∏–ª–∏—Å—å –Ω–∞ –≤–µ—Ä—Ö–Ω–µ–º —É—Ä–æ–≤–Ω–µ
- –ù–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä–∞

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 1. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å—Ç–∞—Ä—Ç–∞ –≤–æ—Ä–∫–µ—Ä–æ–≤ ‚úÖ
**–§–∞–π–ª:** `main.py:9051-9071`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```python
logger.info(f"üîß Creating worker #{i+1}/{len(accounts_list)} for [{data.get('name', phone)}]")
logger.info(f"   Phone: {phone}")
logger.info(f"   Status: {data.get('status', 'unknown')}")
logger.info(f"   Session: {'‚úÖ EXISTS' if data.get('session') else '‚ùå MISSING'}")
logger.info(f"   Will process: ALL {len(channels_copy)} channels")
logger.info(f"   Offset: starts from channel #{(i % len(channels_copy)) + 1}")

task = asyncio.create_task(...)
task.set_name(f"worker_{i}_{phone[-10:]}")
logger.info(f"   ‚úÖ Task created: {task.get_name()} (id={id(task)})")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –¢–µ–ø–µ—Ä—å –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –≤–∏–¥–Ω–æ:
- –ö–∞–∫–æ–π –∏–º–µ–Ω–Ω–æ –∞–∫–∫–∞—É–Ω—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- –ï—Å—Ç—å –ª–∏ —É –Ω–µ–≥–æ —Å–µ—Å—Å–∏—è
- Task ID –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω –ø–æ–¥—Å—á–µ—Ç –∂–∏–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤ ‚úÖ
**–§–∞–π–ª:** `main.py:1378-1410`

**–ë—ã–ª–æ:**
```python
alive_workers = sum(1 for task in self.active_worker_tasks if not task.done())
```

**–°—Ç–∞–ª–æ:**
```python
alive_workers = 0
dead_workers = []
for task in self.active_worker_tasks:
    if task.done():
        dead_workers.append((task.get_name(), task))
    else:
        alive_workers += 1

logger.debug(f"üè• Worker status check:")
logger.debug(f"   Total tracked: {len(self.active_worker_tasks)}")
logger.debug(f"   Alive: {alive_workers}")
logger.debug(f"   Dead: {len(dead_workers)}")

if dead_workers:
    logger.warning(f"üíÄ Dead workers detected: {len(dead_workers)}")
    for task_name, task in dead_workers:
        try:
            exc = task.exception()
            logger.warning(f"   {task_name}: {exc}")
        except Exception:
            logger.warning(f"   {task_name}: Cancelled or completed")
    
    # –û—á–∏—â–∞–µ–º –º–µ—Ä—Ç–≤—ã–µ —Ç–∞—Å–∫–∏
    logger.info(f"üßπ Cleaning up {len(dead_workers)} dead workers")
    self.active_worker_tasks = [task for task in self.active_worker_tasks if not task.done()]
    logger.info(f"‚úÖ Active workers list updated: {len(self.active_worker_tasks)} tasks remaining")
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç –∂–∏–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –º–µ—Ä—Ç–≤—ã—Ö –∏–∑ —Å–ø–∏—Å–∫–∞
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏—á–∏–Ω—ã –ø–∞–¥–µ–Ω–∏—è –∫–∞–∂–¥–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞

### 3. –î–æ–±–∞–≤–ª–µ–Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –≤ account_worker ‚úÖ
**–§–∞–π–ª:** `main.py:8467-8548`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
- –û–±–µ—Ä—Ç–∫–∞ `try/except` –≤–æ–∫—Ä—É–≥ –≤—Å–µ–≥–æ —Ç–µ–ª–∞ –≤–æ—Ä–∫–µ—Ä–∞
- –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ:
```python
logger.info("="*80)
logger.info(f"üöÄ WORKER PROCESS STARTING")
logger.info(f"   Worker ID: {worker_task_name}")
logger.info(f"   Account: {account_name} ({phone})")
logger.info(f"   Status: {account_data.get('status', 'UNKNOWN')}")
logger.info(f"   Task ID: {id(asyncio.current_task())}")
logger.info(f"   Index: {worker_index + 1}/{total_workers}")
logger.info(f"   Mode: {mode.upper()}")
logger.info("="*80)
```

### 4. –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä–∞ ‚úÖ
**–§–∞–π–ª:** `main.py:8895-8935`

**–î–æ–±–∞–≤–ª–µ–Ω–æ:**
```python
except Exception as outer_e:
    logger.error("="*80)
    logger.error(f"üí• WORKER FATAL ERROR: {worker_task_name}")
    logger.error(f"   Account: {account_name} ({phone})")
    logger.error(f"   Error: {outer_e}")
    logger.error(f"   Traceback:")
    logger.error(traceback.format_exc())
    logger.error("="*80)
    
    # –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞
    try:
        await self.bot_client.send_message(
            BOT_OWNER_ID,
            f"üí• **–í–û–†–ö–ï–† –£–ü–ê–õ**\n\n"
            f"–ê–∫–∫–∞—É–Ω—Ç: `{account_name}`\n"
            f"–¢–µ–ª–µ—Ñ–æ–Ω: `{phone}`\n"
            f"–û—à–∏–±–∫–∞: `{str(outer_e)[:200]}`\n\n"
            f"üîÑ –°–∏—Å—Ç–µ–º–∞ –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ health check"
        )
    except:
        pass

finally:
    logger.info("="*80)
    logger.info(f"üõë WORKER STOPPING: {worker_task_name}")
    logger.info(f"   Account: {account_name} ({phone})")
    logger.info(f"   Reason: {'Normal exit' if self.monitoring else 'Monitoring stopped'}")
    logger.info("="*80)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞ –ø—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä–∞
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü–∞ –≤ Telegram
- –ü–æ–Ω—è—Ç–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏

## –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç

–ü–æ—Å–ª–µ —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. ‚úÖ –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ N –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å N –≤–æ—Ä–∫–µ—Ä–æ–≤
2. ‚úÖ –í –ª–æ–≥–∞—Ö –≤–∏–¥–Ω–æ —Å—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ –≤–æ—Ä–∫–µ—Ä–∞ (Task ID, –∏–º—è, –ø—Ä–∏—á–∏–Ω–∞ –ø–∞–¥–µ–Ω–∏—è)
3. ‚úÖ –ü—Ä–∏ –ø–∞–¥–µ–Ω–∏–∏ –≤–æ—Ä–∫–µ—Ä–∞:
   - –õ–æ–≥–∏—Ä—É–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è —Ç—Ä–∞—Å—Å–∏—Ä–æ–≤–∫–∞
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü—É
   - Health check –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º—É –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç
4. ‚úÖ –°—á–µ—Ç—á–∏–∫ "–†–∞–±–æ—Ç–∞–µ—Ç" —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∂–∏–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
5. ‚úÖ –ú–µ—Ä—Ç–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É–¥–∞–ª—è—é—Ç—Å—è –∏–∑ —Å–ø–∏—Å–∫–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞
1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 6 –∞–∫—Ç–∏–≤–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:
   ```
   üîß Creating worker #1/6 for [Account1]
   üîß Creating worker #2/6 for [Account2]
   ...
   ‚úÖ Task created: worker_0_8622376920 (id=123456)
   ‚úÖ Task created: worker_1_8622376921 (id=123457)
   ```
4. –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç: 6 –≤–æ—Ä–∫–µ—Ä–æ–≤ –∑–∞–ø—É—â–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ü–∞–¥–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–∞
1. –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –æ—à–∏–±–∫—É –≤ –æ–¥–Ω–æ–º –∏–∑ –≤–æ—Ä–∫–µ—Ä–æ–≤
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:
   ```
   üí• WORKER FATAL ERROR: worker_2_8622376922
      Account: TestAccount
      Error: Some error
      Traceback: ...
   ```
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å health check (—á–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã):
   ```
   üíÄ Dead workers detected: 1
      worker_2_8622376922: Some error
   üßπ Cleaning up 1 dead workers
   ‚úÖ Active workers list updated: 5 tasks remaining
   ```
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: Health check
1. –î–æ–∂–¥–∞—Ç—å—Å—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è health check
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤ –ª–æ–≥–∞—Ö:
   ```
   üè• Worker status check:
      Total tracked: 6
      Alive: 6
      Dead: 0
   ‚úÖ Health check OK: 6/6 workers
   ```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- `main.py` - –æ—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ —Ñ—É–Ω–∫—Ü–∏—è—Ö:
  - `pro_auto_comment()` - —Å–æ–∑–¥–∞–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤ —Å Task ID
  - `account_worker()` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
  - `health_check_worker()` - –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ø–æ–¥—Å—á–µ—Ç –∏ –æ—á–∏—Å—Ç–∫–∞

## –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏
1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
2. –ù–∞–±–ª—é–¥–∞—Ç—å –ª–æ–≥–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —á–∞—Å–æ–≤
3. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ—Ç–∫–æ—Ä—Ä–µ–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã health check
