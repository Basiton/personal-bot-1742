# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ YandexGPT

## –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –±–æ—Ç–∞

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞ –≤ –ª–æ–≥–∞—Ö –ø–æ—è–≤–∏—Ç—Å—è –±–ª–æ–∫ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ YandexGPT:

```
============================================================
üîç –ü–†–û–í–ï–†–ö–ê YANDEX GPT –û–ö–†–£–ñ–ï–ù–ò–Ø
============================================================
‚úÖ YC_API_KEY –Ω–∞–π–¥–µ–Ω: AQVNxxx***xxxx
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è YC_API_KEY
‚úÖ YC_FOLDER_ID –Ω–∞–π–¥–µ–Ω: b1g4or5i5s66hklqfg06
   –ò—Å—Ç–æ—á–Ω–∏–∫: –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –æ–∫—Ä—É–∂–µ–Ω–∏—è YC_FOLDER_ID

‚úÖ YANDEX GPT: –í–ö–õ–Æ–ß–Å–ù
   Model URI: gpt://b1g4or5i5s66hklqfg06/yandexgpt/latest
   Endpoint: https://llm.api.cloud.yandex.net/foundationModels/v1/completion
============================================================
```

–ò–ª–∏ –≤ —Å–ª—É—á–∞–µ –ø—Ä–æ–±–ª–µ–º:
```
‚ùå API KEY –ù–ï –ù–ê–ô–î–ï–ù!
   –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è: YC_API_KEY –∏–ª–∏ YANDEX_API_KEY
   YandexGPT –±—É–¥–µ—Ç –û–¢–ö–õ–Æ–ß–ï–ù, –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —à–∞–±–ª–æ–Ω—ã
```

### 2. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞ –∫ YandexGPT

–ü—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è:

```
ü§ñ YANDEX GPT: –Ω–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è
   Model URI: gpt://b1g4or5i5s66hklqfg06/yandexgpt/latest
   Temperature: 0.8, Max tokens: 120
   Prompt length: 650 chars
   Post text length: 234 chars
   Channel theme: –æ–±—â–∞—è
üì° –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –∫ YandexGPT API...
üì• –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç –æ—Ç YandexGPT: HTTP 200
‚úÖ JSON —É—Å–ø–µ—à–Ω–æ —Ä–∞—Å–ø–∞—Ä—Å–µ–Ω
üìù –°—ã—Ä–æ–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç YandexGPT: '–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥ –∫ —Ä–µ—à–µ–Ω–∏—é –∑–∞–¥–∞—á–∏! üî•'
‚ú® –§–∏–Ω–∞–ª—å–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏: '–ò–Ω—Ç–µ—Ä–µ—Å–Ω—ã–π –ø–æ–¥—Ö–æ–¥! üî•'
üéâ YandexGPT: –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
```

### 3. –î–µ—Ç–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

–ü—Ä–∏ –æ—à–∏–±–∫–∞—Ö API –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

```
‚ùå YandexGPT API error: HTTP 401
   Response headers: {...}
   Error response body: {"error": "unauthorized", ...}
   –ü—Ä–∏—á–∏–Ω–∞: –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞
‚ö†Ô∏è  –ò—Å–ø–æ–ª—å–∑—É—é fallback —à–∞–±–ª–æ–Ω—ã –∏–∑-–∑–∞ –æ—à–∏–±–∫–∏ API
```

–¢–∏–ø—ã –æ—à–∏–±–æ–∫:
- **400**: –ù–µ–≤–µ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ folder_id –∏ —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞)
- **401**: –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á –∏–ª–∏ –Ω–µ—Ç –¥–æ—Å—Ç—É–ø–∞
- **403**: –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â—ë–Ω (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –Ω–∞ folder_id)
- **429**: –ü—Ä–µ–≤—ã—à–µ–Ω –ª–∏–º–∏—Ç –∑–∞–ø—Ä–æ—Å–æ–≤ (rate limit)
- **Timeout**: API –Ω–µ –æ—Ç–≤–µ—Ç–∏–ª –≤ —Ç–µ—á–µ–Ω–∏–µ 30 —Å–µ–∫—É–Ω–¥
- **ConnectionError**: –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –∫ API (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç)

## –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 1. –û—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –±–æ—Ç–∞
```bash
sudo systemctl stop comapc-bot
```

### 2. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç–µ systemd (–µ—Å–ª–∏ –º–µ–Ω—è–ª–∏ unit-—Ñ–∞–π–ª)
```bash
sudo systemctl daemon-reload
```

### 3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞
```bash
sudo systemctl start comapc-bot
```

### 4. –°–º–æ—Ç—Ä–∏—Ç–µ –ª–æ–≥–∏

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏:**
```bash
sudo journalctl -u comapc-bot -n 100 --no-pager | grep -A 20 "–ü–†–û–í–ï–†–ö–ê YANDEX GPT"
```

–î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –±–ª–æ–∫ —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è.

**–ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤:**
```bash
sudo journalctl -u comapc-bot -f | grep -E "YANDEX GPT|YandexGPT"
```

–°–ª–µ–¥–∏—Ç–µ –∑–∞:
- `ü§ñ YANDEX GPT: –Ω–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é` ‚Äî –∑–∞–ø—Ä–æ—Å –Ω–∞—á–∞–ª—Å—è
- `üì° –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å` ‚Äî –∑–∞–ø—Ä–æ—Å –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω
- `üì• –ü–æ–ª—É—á–µ–Ω –æ—Ç–≤–µ—Ç: HTTP 200` ‚Äî –æ—Ç–≤–µ—Ç –ø–æ–ª—É—á–µ–Ω
- `üéâ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω` ‚Äî —É—Å–ø–µ—à–Ω–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è
- `‚ùå YandexGPT API error` ‚Äî –æ—à–∏–±–∫–∞ API
- `‚ö†Ô∏è  –ò—Å–ø–æ–ª—å–∑—É—é fallback —à–∞–±–ª–æ–Ω—ã` ‚Äî –±–æ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∏–ª—Å—è –Ω–∞ —à–∞–±–ª–æ–Ω—ã

**–í–µ—Å—å –ª–æ–≥ –±–æ—Ç–∞ (–ø–æ—Å–ª–µ–¥–Ω–∏–µ 200 —Å—Ç—Ä–æ–∫):**
```bash
sudo journalctl -u comapc-bot -n 200 --no-pager
```

**–õ–æ–≥ –≤ —Ñ–∞–π–ª–µ (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è):**
```bash
tail -f /root/bot/bot.log | grep -E "YANDEX|YandexGPT"
```

## –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –µ—Å–ª–∏ YandexGPT –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –í –ª–æ–≥–∞—Ö –Ω–µ—Ç –±–ª–æ–∫–∞ "–ü–†–û–í–ï–†–ö–ê YANDEX GPT"
- –ë–æ—Ç –Ω–µ –∑–∞–ø—É—Å—Ç–∏–ª—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è –∫–æ–¥–∞
- –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã, –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "‚ùå API KEY –ù–ï –ù–ê–ô–î–ï–ù"
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
- –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `/etc/systemd/system/comapc-bot.service`:
  ```
  Environment="YC_API_KEY=–≤–∞—à_–∫–ª—é—á"
  Environment="YC_FOLDER_ID=–≤–∞—à_folder_id"
  ```
- –ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π: `sudo systemctl daemon-reload && sudo systemctl restart comapc-bot`

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "‚ùå YandexGPT API error: HTTP 401"
- –ù–µ–≤–µ—Ä–Ω—ã–π API –∫–ª—é—á
- –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∫–ª—é—á–∞ –≤ systemd unit

### –ü—Ä–æ–±–ª–µ–º–∞ 4: "‚ùå YandexGPT API error: HTTP 403"
- –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ folder_id
- –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ —Å–µ—Ä–≤–∏—Å–Ω–æ–º –∞–∫–∫–∞—É–Ω—Ç–µ YC –µ—Å—Ç—å —Ä–æ–ª—å `ai.languageModels.user`

### –ü—Ä–æ–±–ª–µ–º–∞ 5: "‚ùå YandexGPT API error: HTTP 400"
- –ù–µ–≤–µ—Ä–Ω—ã–π folder_id –∏–ª–∏ —Ñ–æ—Ä–º–∞—Ç –∑–∞–ø—Ä–æ—Å–∞
- –†–µ—à–µ–Ω–∏–µ: –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å YC_FOLDER_ID

### –ü—Ä–æ–±–ª–µ–º–∞ 6: –í–∏–¥–Ω—ã –∑–∞–ø—Ä–æ—Å—ã –∫ API, –Ω–æ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ —à–∞–±–ª–æ–Ω–Ω—ã–µ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –≤ –ª–æ–≥–∞—Ö –µ—Å—Ç—å `üéâ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω`
- –ï—Å–ª–∏ –µ—Å—Ç—å, —Ç–æ YandexGPT —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —Å–º–æ—Ç—Ä–∏—Ç–µ –æ—à–∏–±–∫–∏ –º–µ–∂–¥—É `üì° –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å` –∏ —Ñ–∏–Ω–∞–ª–æ–º

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
sudo journalctl -u comapc-bot --since "5 minutes ago" | grep -A 15 "–ü–†–û–í–ï–†–ö–ê YANDEX GPT"

# –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
sudo journalctl -u comapc-bot -f | grep --color=always -E "YANDEX GPT|YandexGPT|fallback"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫
sudo journalctl -u comapc-bot --since "1 hour ago" | grep -B 2 -A 5 "‚ùå.*YandexGPT"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ø–µ—à–Ω—ã—Ö –≥–µ–Ω–µ—Ä–∞—Ü–∏–π
sudo journalctl -u comapc-bot --since "1 hour ago" | grep "üéâ.*–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ"

# –ü–æ–¥—Å—á—ë—Ç —É—Å–ø–µ—à–Ω—ã—Ö vs fallback –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
echo "–£—Å–ø–µ—à–Ω—ã—Ö YandexGPT:"
sudo journalctl -u comapc-bot --since "1 hour ago" | grep -c "–∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω"
echo "Fallback —à–∞–±–ª–æ–Ω–æ–≤:"
sudo journalctl -u comapc-bot --since "1 hour ago" | grep -c "–ò—Å–ø–æ–ª—å–∑—É—é fallback"
```

## –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

–ü—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ:

1. **–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –±–æ—Ç–∞:**
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è —Å –∑–∞–º–∞—Å–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –∫–ª—é—á–æ–º
   - –°—Ç–∞—Ç—É—Å "YANDEX GPT: –í–ö–õ–Æ–ß–Å–ù"

2. **–ü—Ä–∏ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏:**
   - –ó–∞–ø—Ä–æ—Å –∫ YandexGPT API
   - HTTP 200 –æ—Ç–≤–µ—Ç
   - –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ –∏–∑ —à–∞–±–ª–æ–Ω–æ–≤)
   - –£—Å–ø–µ—à–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è

3. **–ü—Ä–∏ –æ—à–∏–±–∫–µ:**
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –æ—à–∏–±–∫–∏ (–∫–æ–¥, –ø—Ä–∏—á–∏–Ω–∞)
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π fallback –Ω–∞ —à–∞–±–ª–æ–Ω—ã
   - –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞

