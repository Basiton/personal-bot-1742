# ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –±–∞–Ω–∞

## üéØ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤
```python
self.active_worker_tasks = []  # –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
self.worker_recovery_enabled = True  # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```

### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –∑–∞–º–µ–Ω—ã –∞–∫–∫–∞—É–Ω—Ç–∞
**–§—É–Ω–∫—Ü–∏—è:** `restart_monitoring_after_replacement()`

**–ö–æ–≥–¥–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç:**
- –ê–∫–∫–∞—É–Ω—Ç –∑–∞–±–∞–Ω–µ–Ω (USER_DEACTIVATED / AUTH_KEY_UNREGISTERED)
- –†–µ–∑–µ—Ä–≤–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
- –°–∏—Å—Ç–µ–º–∞ –∂–¥—ë—Ç 10 —Å–µ–∫—É–Ω–¥
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

**–ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç:**
```
1. –ë–∞–Ω –æ–±–Ω–∞—Ä—É–∂–µ–Ω ‚Üí handle_account_ban()
2. –ê–∫–∫–∞—É–Ω—Ç –ø–æ–º–µ—á–µ–Ω BROKEN ‚Üí replace_broken_account()
3. –†–µ–∑–µ—Ä–≤–Ω—ã–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω ‚Üí restart_monitoring_after_replacement()
4. –û–∂–∏–¥–∞–Ω–∏–µ 10 —Å–µ–∫
5. monitoring = False (–æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å—Ç–∞—Ä—ã–µ –≤–æ—Ä–∫–µ—Ä—ã)
6. –û–∂–∏–¥–∞–Ω–∏–µ 5 —Å–µ–∫
7. monitoring = True (–∑–∞–ø—É—Å–∫–∞–µ–º –Ω–æ–≤—ã–µ)
8. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü—É
```

### 3. Health Check Worker
**–§—É–Ω–∫—Ü–∏—è:** `health_check_worker()`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
- –°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç –æ–∂–∏–¥–∞–µ–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤ —Å —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–º
- –ü—Ä–∏ –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç —Å–∏—Å—Ç–µ–º—É

**–õ–æ–≥–∏–∫–∞:**
```python
expected_workers = min(len(active_accounts), max_parallel_accounts)
alive_workers = count(not_done_tasks)

if alive_workers < expected_workers:
    # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
    restart_monitoring_after_replacement()
```

---

## üöÄ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ë–∞–Ω –∞–∫–∫–∞—É–Ω—Ç–∞

**–î–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```
3 –≤–æ—Ä–∫–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
–í–æ—Ä–∫–µ—Ä #2 –∑–∞–±–∞–Ω–µ–Ω
‚Üì
–ê–∫–∫–∞—É–Ω—Ç –ø–æ–º–µ—á–µ–Ω BROKEN
–†–µ–∑–µ—Ä–≤–Ω—ã–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
‚ùå –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Å 2 –≤–æ—Ä–∫–µ—Ä–∞–º–∏
‚ùå –†–µ–∑–µ—Ä–≤–Ω—ã–π –∞–∫–∫–∞—É–Ω—Ç –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç
```

**–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π:**
```
3 –≤–æ—Ä–∫–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç
–í–æ—Ä–∫–µ—Ä #2 –∑–∞–±–∞–Ω–µ–Ω
‚Üì
–ê–∫–∫–∞—É–Ω—Ç –ø–æ–º–µ—á–µ–Ω BROKEN
–†–µ–∑–µ—Ä–≤–Ω—ã–π –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω
‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫"
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫
‚úÖ 3 –Ω–æ–≤—ã—Ö –≤–æ—Ä–∫–µ—Ä–∞ (—Å —Ä–µ–∑–µ—Ä–≤–Ω—ã–º –≤–º–µ—Å—Ç–æ –∑–∞–±–∞–Ω–µ–Ω–Ω–æ–≥–æ)
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –í–æ—Ä–∫–µ—Ä —É–ø–∞–ª –ø–æ –¥—Ä—É–≥–æ–π –ø—Ä–∏—á–∏–Ω–µ

**Health check –æ–±–Ω–∞—Ä—É–∂–∏—Ç:**
```
–ö–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã –ø—Ä–æ–≤–µ—Ä–∫–∞:
Expected: 3 workers
Running: 2 workers
Missing: 1 worker

‚Üì
‚ö†Ô∏è –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤–ª–∞–¥–µ–ª—å—Ü—É
üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ 10 —Å–µ–∫
‚úÖ –°–∏—Å—Ç–µ–º–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
```

---

## üì± –ù–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã

### `/togglerecovery`
–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ

```bash
# –í—ã–∫–ª—é—á–∏—Ç—å
/togglerecovery
‚Üí ‚ùå –í—ã–∫–ª—é—á–µ–Ω–æ
   ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Ä—É—á–Ω–æ–π –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ –ø–æ—Å–ª–µ –±–∞–Ω–∞

# –í–∫–ª—é—á–∏—Ç—å
/togglerecovery
‚Üí ‚úÖ –í–∫–ª—é—á–µ–Ω–æ
   üìå –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è –ø—Ä–∏ –∑–∞–º–µ–Ω–µ –∞–∫–∫–∞—É–Ω—Ç–∞
```

### `/getworkersettings`
–û–±–Ω–æ–≤–ª—ë–Ω, —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è

---

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏

### –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
```python
self.worker_recovery_enabled = True  # –ê–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ
```

### Health check –∏–Ω—Ç–µ—Ä–≤–∞–ª
```python
await asyncio.sleep(120)  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
```

### –ó–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```python
await asyncio.sleep(10)  # 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Å—Ç–∞—Ä—ã—Ö –≤–æ—Ä–∫–µ—Ä–æ–≤
await asyncio.sleep(5)   # 5 —Å–µ–∫—É–Ω–¥ –Ω–∞ –æ—á–∏—Å—Ç–∫—É
```

---

## üìä –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü—É

### –ü—Ä–∏ –∑–∞–º–µ–Ω–µ –∞–∫–∫–∞—É–Ω—Ç–∞
```
‚ö†Ô∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–º–µ–Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–∞

üî¥ –°–ª–æ–º–∞–Ω: Account #2 (+79123456789)
–ü—Ä–∏—á–∏–Ω–∞: Account Deactivated

‚úÖ –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —Ä–µ–∑–µ—Ä–≤–Ω—ã–π: Account #4 (+79987654321)

üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ: Active: 3, Reserve: 1, Broken: 1

üîÑ –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
```

### –ü–æ—Å–ª–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```
‚úÖ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø–µ—Ä–µ–∑–∞–ø—É—â–µ–Ω

üöÄ –ù–æ–≤—ã–µ –≤–æ—Ä–∫–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã —Å –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–º —Å–æ—Å—Ç–∞–≤–æ–º –∞–∫–∫–∞—É–Ω—Ç–æ–≤
üìä –°–æ—Å—Ç–æ—è–Ω–∏–µ: Active: 3, Reserve: 1, Broken: 1
```

### –ü—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º—ã
```
‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ —Å –≤–æ—Ä–∫–µ—Ä–∞–º–∏

–û–∂–∏–¥–∞–µ—Ç—Å—è: 3
–†–∞–±–æ—Ç–∞–µ—Ç: 2
–ù–µ–¥–æ—Å—Ç–∞—ë—Ç: 1

üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 10 —Å–µ–∫—É–Ω–¥
```

### –ü—Ä–∏ –æ—à–∏–±–∫–µ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞
```
‚ùå –û—à–∏–±–∫–∞ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞

–ü—Ä–∏—á–∏–Ω–∞: [error details]

üí° –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ /stopmon –∏ /startmon –≤—Ä—É—á–Ω—É—é
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –ó–∞–º–µ–Ω–∞ –ø–æ—Å–ª–µ –±–∞–Ω–∞
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
/startmon

# –°–∏–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –±–∞–Ω (–æ—Ç–æ–∑–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö Telegram)
# –°–∏—Å—Ç–µ–º–∞ –¥–æ–ª–∂–Ω–∞:
1. –û–±–Ω–∞—Ä—É–∂–∏—Ç—å –±–∞–Ω
2. –£–≤–µ–¥–æ–º–∏—Ç—å –æ –∑–∞–º–µ–Ω–µ
3. –ü–æ–¥–æ–∂–¥–∞—Ç—å 10 —Å–µ–∫
4. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è
5. –£–≤–µ–¥–æ–º–∏—Ç—å –æ–± —É—Å–ø–µ—Ö–µ
```

### –¢–µ—Å—Ç 2: Health check
```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥
/startmon

# –£–±–∏—Ç—å –æ–¥–∏–Ω –≤–æ—Ä–∫–µ—Ä –≤—Ä—É—á–Ω—É—é (kill –ø—Ä–æ—Ü–µ—Å—Å)
# –ß–µ—Ä–µ–∑ 2 –º–∏–Ω—É—Ç—ã:
1. Health check –æ–±–Ω–∞—Ä—É–∂–∏—Ç –ø—Ä–æ–±–ª–µ–º—É
2. –£–≤–µ–¥–æ–º–∏—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞
3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—Å—è
```

### –¢–µ—Å—Ç 3: –í—ã–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```bash
/togglerecovery
# ‚Üí ‚ùå –í—ã–∫–ª—é—á–µ–Ω–æ

# –¢–µ–ø–µ—Ä—å –ø—Ä–∏ –±–∞–Ω–µ:
1. –ê–∫–∫–∞—É–Ω—Ç –∑–∞–º–µ–Ω—ë–Ω
2. –ù–û —Å–∏—Å—Ç–µ–º–∞ –ù–ï –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
3. –¢—Ä–µ–±—É–µ—Ç—Å—è /stopmon ‚Üí /startmon –≤—Ä—É—á–Ω—É—é
```

---

## üîç –õ–æ–≥–∏

### –£—Å–ø–µ—à–Ω–æ–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ
```
[2026-01-17 12:34:56] üö´ Account ban detected: +79123456789 - Account Deactivated
[2026-01-17 12:34:56] ‚úÖ Replaced broken account: Account #2 ‚Üí Reserve #4
[2026-01-17 12:34:56] üîÑ Scheduling monitoring restart in 10 seconds...
[2026-01-17 12:35:06] ================================================================================
[2026-01-17 12:35:06] üîÑ RESTARTING MONITORING AFTER ACCOUNT REPLACEMENT
[2026-01-17 12:35:06] ================================================================================
[2026-01-17 12:35:06] ‚è∏Ô∏è Stopping current workers...
[2026-01-17 12:35:06] ‚è≥ Waiting for 3 workers to finish...
[2026-01-17 12:35:11] üöÄ Starting new workers with updated accounts...
[2026-01-17 12:35:11] ‚úÖ Monitoring restarted successfully
```

### Health check –æ–±–Ω–∞—Ä—É–∂–∏–ª –ø—Ä–æ–±–ª–µ–º—É
```
[2026-01-17 12:40:00] ================================================================================
[2026-01-17 12:40:00] ‚ö†Ô∏è WORKER COUNT MISMATCH DETECTED!
[2026-01-17 12:40:00]    Expected: 3 workers
[2026-01-17 12:40:00]    Running: 2 workers
[2026-01-17 12:40:00]    Missing: 1 workers
[2026-01-17 12:40:00] ================================================================================
[2026-01-17 12:40:00] üîÑ Initiating automatic recovery...
```

---

## ‚úÖ –ò—Ç–æ–≥

| –§—É–Ω–∫—Ü–∏—è | –°—Ç–∞—Ç—É—Å |
|---------|--------|
| –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ –±–∞–Ω–∞ | ‚úÖ –ë—ã–ª–æ |
| –ó–∞–º–µ–Ω–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ | ‚úÖ –ë—ã–ª–æ |
| **–ê–≤—Ç–æ–ø–µ—Ä–µ–∑–∞–ø—É—Å–∫** | ‚úÖ **–ù–û–í–û–ï** |
| **Health check** | ‚úÖ **–ù–û–í–û–ï** |
| **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–æ—Ä–∫–µ—Ä–æ–≤** | ‚úÖ **–ù–û–í–û–ï** |
| –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è | ‚úÖ –£–ª—É—á—à–µ–Ω–æ |
| –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ –∫–æ–º–∞–Ω–¥—ã | ‚úÖ **–ù–û–í–û–ï** |

**–°–∏—Å—Ç–µ–º–∞ —Ç–µ–ø–µ—Ä—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è:**
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç –±–∞–Ω
- ‚úÖ –ó–∞–º–µ–Ω—è–µ—Ç –∞–∫–∫–∞—É–Ω—Ç
- ‚úÖ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ—Ä–∫–µ—Ä–æ–≤
- ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –ø—Ä–æ—Å—Ç–æ–µ–≤
- ‚úÖ –£–≤–µ–¥–æ–º–ª—è–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ
