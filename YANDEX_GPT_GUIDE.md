# YandexGPT Integration Guide

## Что это?

Бот теперь использует YandexGPT для генерации уникальных комментариев на основе содержания поста. Это делает комментарии более естественными и релевантными.

## Настройка

### 1. Получите API ключ Yandex Cloud

1. Зайдите на [Yandex Cloud Console](https://console.cloud.yandex.ru/)
2. Создайте сервисный аккаунт (или используйте существующий)
3. Создайте API-ключ: [Инструкция](https://cloud.yandex.ru/docs/iam/operations/api-key/create)
4. Найдите ваш Folder ID в настройках облака

### 2. Настройте переменные окружения

Создайте файл `.env` в корне проекта (скопируйте `.env.example`):

```bash
cp .env.example .env
```

Отредактируйте `.env` и добавьте ваши данные:

```env
YANDEX_API_KEY=AQVN3lmXBTGu59GwNZXbvQNC5B75nSGAXfpWU_tG
YANDEX_FOLDER_ID=b1g4or5i5s66hklqfg06
```

### 3. Установите зависимости

```bash
pip install -r requirements.txt
```

## Как работает

1. Бот получает последний пост из канала
2. Отправляет текст поста в YandexGPT с промптом
3. YandexGPT генерирует уникальный комментарий (20-50 слов)
4. Комментарий публикуется в обсуждении канала

### Параметры генерации

- **temperature**: 0.8 (креативность)
- **max_tokens**: 120 (длина комментария)
- **Стиль**: дружелюбный, нейтрально-радостный
- **Формат**: 1-2 эмодзи, без ссылок и рекламы

## Fallback система

Если YandexGPT недоступен или не настроен:
- Бот автоматически переключится на шаблонные комментарии
- Никаких ошибок не будет, работа продолжится

## Безопасность

✅ **API ключ защищен:**
- Хранится в `.env` файле (не в коде)
- `.env` добавлен в `.gitignore`
- Не попадет в git репозиторий

⚠️ **Важно:**
- Никогда не коммитьте `.env` файл
- Не показывайте API ключ никому
- Используйте `.env.example` как шаблон

## Стоимость

YandexGPT тарифицируется по токенам:
- ~1000 символов = ~1000 токенов
- Один комментарий = ~700-1000 токенов
- Проверьте актуальные цены: [Yandex Cloud Pricing](https://cloud.yandex.ru/docs/yandexgpt/pricing)

## Отладка

Если комментарии не генерируются:

1. Проверьте логи бота:
```
[WARNING] YANDEX_API_KEY not configured, using fallback comments
```

2. Проверьте `.env` файл:
```bash
cat .env
```

3. Проверьте API ключ в Yandex Cloud Console

4. Тестовый запрос:
```python
import os
import requests

api_key = os.getenv('YANDEX_API_KEY')
folder_id = os.getenv('YANDEX_FOLDER_ID')

print(f"API Key: {api_key[:10]}...")
print(f"Folder ID: {folder_id}")
```

## Отключение YandexGPT

Если хотите вернуться к шаблонным комментариям:
1. Удалите или оставьте пустым `YANDEX_API_KEY` в `.env`
2. Бот автоматически переключится на fallback режим

## Поддержка

Если возникли проблемы:
1. Проверьте логи бота
2. Убедитесь, что API ключ действителен
3. Проверьте баланс Yandex Cloud
4. Убедитесь, что YandexGPT API доступен в вашем регионе
